# DÃ²ng nÃ y xÃ¡c Ä‘á»‹nh phiÃªn báº£n CMake tá»‘i thiá»ƒu cáº§n thiáº¿t Ä‘á»ƒ xÃ¢y dá»±ng dá»± Ã¡n
# PhiÃªn báº£n 3.10 hoáº·c cao hÆ¡n lÃ  cáº§n thiáº¿t Ä‘á»ƒ há»— trá»£ cÃ¡c tÃ­nh nÄƒng CMake hiá»‡n Ä‘áº¡i vÃ  C++17
# Náº¿u khÃ´ng cÃ³ dÃ²ng nÃ y, viá»‡c biÃªn dá»‹ch cÃ³ thá»ƒ tháº¥t báº¡i trÃªn cÃ¡c phiÃªn báº£n CMake cÅ© 
# khÃ´ng cÃ³ cÃ¡c chá»©c nÄƒng cáº§n thiáº¿t
cmake_minimum_required(VERSION 3.10)

# TÃªn dá»± Ã¡n
# Khai bÃ¡o tÃªn dá»± Ã¡n lÃ  "main", vá»›i phiÃªn báº£n 1.0 vÃ  ngÃ´n ngá»¯ Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  C++
project(main VERSION 1.0 LANGUAGES CXX)

# Thay Ä‘á»•i tá»« C++11 thÃ nh C++17
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
# YÃªu cáº§u báº¯t buá»™c pháº£i sá»­ dá»¥ng C++17, náº¿u khÃ´ng cÃ³ sáº½ bÃ¡o lá»—i
set(CMAKE_CXX_STANDARD_REQUIRED True)

# XÃ¡c Ä‘á»‹nh há»‡ Ä‘iá»u hÃ nh
if(APPLE)
    message(STATUS "Compiling on macOS ğŸ¯")
    set(CMAKE_SYSTEM_NAME Darwin)
    set(CMAKE_OSX_DEPLOYMENT_TARGET "11.0")  # Há»— trá»£ tá»« macOS 11 trá»Ÿ lÃªn
    set(CMAKE_CXX_FLAGS "-Wall -Wextra -Wpedantic")
    
    # Thiáº¿t láº­p kiáº¿n trÃºc Universal (Intel + Apple Silicon)
    set(CMAKE_OSX_ARCHITECTURES "x86_64;arm64")
    
    # RPATH Ä‘á»ƒ trÃ¡nh lá»—i thiáº¿u thÆ° viá»‡n khi cháº¡y app
    set(CMAKE_INSTALL_RPATH "@loader_path/../lib")
endif()

# ThÃªm Ä‘Æ°á»ng dáº«n Ä‘áº¿n thÆ° má»¥c Header Ä‘á»ƒ compiler cÃ³ thá»ƒ tÃ¬m tháº¥y cÃ¡c file header
include_directories(Header)

# Táº¡o file thá»±c thi cÃ³ tÃªn lÃ  MyExecutable tá»« cÃ¡c file nguá»“n:
# - main.cpp (file chÃ­nh)
# - std_unique_ptr.cpp (trong thÆ° má»¥c SourcesFile)
# - virtual_destructor.cpp (trong thÆ° má»¥c SourcesFile)
add_executable(MyExecutable 
    main.cpp 
    SourcesFile/std_unique_ptr.cpp 
    SourcesFile/virtual_destructor.cpp
)

# Chá»‰ Ä‘á»‹nh thÆ° má»¥c output cho file thá»±c thi
# ${CMAKE_BINARY_DIR} lÃ  Ä‘Æ°á»ng dáº«n Ä‘áº¿n thÆ° má»¥c build
# File thá»±c thi sáº½ Ä‘Æ°á»£c táº¡o trong thÆ° má»¥c build/bin
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)